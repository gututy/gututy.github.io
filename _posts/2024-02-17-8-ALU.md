---
title: 运算器设计
tags: 计算机体系结构 学习笔记
permalink: /notes/ca/ALU
aside:
    toc: ture
sidebar:
    nav: notes
---

# 二进制与逻辑电路
## 计算机中数的表示
   > 要表示的数有哪些
   > - 整数(正整数、0、负整数)
   > - 有理数和无理数(0.1、$\frac{2}{3}$、$\pi$)
   > - 字符串(通过ASCII码转换为数字，00表示字符串结束)

### 数制
  - 根据进位方式的不同，划分为不同数制
  - 对于任意R进制数$A=a_na_{n-1}...a_1a_0a_{-1}a_{-2}...a_{-m+1}a_{-m}$所表示的十进制数为
  $$
  Value(A) = a_n \times R^n + a_{n-1} \times R^{n-1} + ... + a_1 \times R^1 + a_0 \times R^0 + a_{-1} \times R^{-1} + a_{-2} \times R^{-2} + ... + a_{-m+1} \times R^{-m+1} + a_{-m} \times R^{-m}
  $$
- 为什么计算机用二进制
  - 格式简单，只有0/1两个数，正好对应逻辑命题的真和假
- 定浮点表示
  - 定点数
    - 小数点固定(最右边)
    - 用于表示整数
  - 浮点数
    - 小数点可以浮动
    - 用于表示实数


### 定点数的编码规则
#### 原码：直接表示二进制
    - 将数去掉符号位表示成二进制，对齐长度之后补上符号位
    - 优点：
        1. 与人们日常记录正负数的习惯相近，与真实数值之间的对应关系直观，利于与真实数值相互转换
        2. 原码实现乘除运算比较简便直接
    - 缺点：
        1. 存在两个0，+0和-0
        2. 原码的加减运算规则复杂，需要判断是否是同号相减或者是异号相加，如果是需要根据绝对值大小判断结果的正负号
#### 补码
    - 定义：$[X]_补 = 2^n + X (mod \space 2^n), \space\quad -2^{n-1} \leq X < 2^{n-1}$
    - 简便算法
      - 正数补码是本身($[X]_补=X$)
      - 负数补码是本身的值按位取反后+1($[X]_补= \overline{X} +1 $)
      - 最高位还是符号位
    - 优点
      - $[X+Y]_补 = [X]_补 + [Y]_{补}$
      - $[X-Y]_补 = [X]_补 + \overline{[Y]_补} +1$
      - 比原码能多表示一个数($-2^{n-1}$)
#### 溢出
    - 同号相加或异号相减可能溢出
    - **溢出就是运算的算术结果超出了表示范围**

### 浮点数表示
  > 定点数只能表示整数，除法不准确
  > 定点数表示范围较小
  > 如何表示浮点数中的小数点(IEEE754标准)
#### IEEE754标准
  - 浮点数标识为符号位S、尾数F和阶码E
    - 科学计数法：没有前导零，小数点左侧只有一个整数
  - 规定
    - 符号S为0表示正数
    - 尾数F用$\color{#FF0000}{原码}$表示，为101...
    - 阶码E用$\color{#FF0000}{移码}$表示，1+shift；偏移常量对于单精度和双精度的来说分别是127和1023
    - 数的位数
      - 单精度：1位S，8位E，23位F
      - 双精度：1位S，11位E，52位F
  
![IEEE754](/assets/ca/第八章图/IEEE754.png)

- 一些特殊值
  - 无穷大(阶码全1尾数全0)
  - 非数(阶码全1尾数非0)
  - 零(阶码全0尾数全0)
  - 非规格化非零(阶码全0尾数非0)

## MOS晶体管工作原理
- P型材料
  - 硅(Si)中掺杂3价元素(硼B)，有空穴
- N型材料
  - 硅(Si)中掺杂5价元素(磷P)，有自由电子
- PN结
  - P型材料和N型材料挨在一起，少量电子从N向P流动
  - P区带了负电，N区带了正电，形成稳定区
![MOS管原理](/assets/ca/第八章图/MOS管原理.png)
![MOS管原理2](/assets/ca/第八章图/MOS管原理2.png)

### NMOS管
- 两块掺杂度较高的N区，掺杂度较低的P区衬底
- 还包括源极、漏极、栅极和栅氧层

![NMOS1](/assets/ca/第八章图/NMOS1.png)
- 当栅极接地时，不导电
  - 两对PN结形成稳定区
  - 两片电子密集区不导通

![NMOS2](/assets/ca/第八章图/NMOS2.png)
- 当栅极接高电压时，形成沟道，导电
  - 栅氧层存在电势差，将P区少量自由电子吸引聚集
  - 形成电子沟道，使得两块N区导通，电势差导致电子流通

![NMOS3](/assets/ca/第八章图/NMOS3.png)

### PMOS管
- 两块掺杂度高的P区，掺杂较低的N区衬底

![PMOS1](/assets/ca/第八章图/PMOS1.png)
- 当栅极接地，空穴区联通

![PMOS2](/assets/ca/第八章图/PMOS2.png)

- 当栅极接电，空穴区断开

![PMOS3](/assets/ca/第八章图/PMOS3.png)

----------

- NMOS，栅接高电压，源和漏导通

![NMOS开关](/assets/ca/第八章图/NMOS等效开关.png)

- PMOS，栅接地，源和漏导通

![PMOS开关](/assets/ca/第八章图/PMOS等效开关.png)

### 使用MOS管设计CMOS逻辑电路
- 使用互补(Complementary)的PMOS和NMOS组成电路
  - 不论什么输入输出，都不会有从电源到地的直流漏电
- 有些定制电路为了速度直接使用NMOS或PMOS